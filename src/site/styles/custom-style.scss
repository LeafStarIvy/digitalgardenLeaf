/*
 * COSMIC DIGITAL GARDEN - DEEP SPACE THEME
 * Inspired by Super Mario Galaxy and deep space aesthetics
 * Color palette: Deep space blues, stellar grays, cosmic whites
 */

// =====================================================================
// 1. CORE VARIABLES - COSMIC BLUE & GRAY PALETTE
// =====================================================================
body {
  /* === DEEP SPACE COLOR SYSTEM === */
  
  /* Primary Deep Space Scale */
  --cosmic-void: #000511;           /* Absolute void */
  --cosmic-abyss: #001122;          /* Deep abyss */
  --space-deep: #002244;            /* Deepest space */
  --space-darker: #003366;          /* Darker space */
  --space-dark: #004488;            /* Dark space */
  --space-medium: #0066AA;          /* Medium space */
  --space-light: #0088CC;           /* Light space */
  --space-lighter: #33AADD;         /* Lighter space */
  --space-lightest: #66CCEE;        /* Lightest space */
  
  /* Stellar Gray Scale */
  --stellar-void: #0A0A0F;          /* Void gray */
  --stellar-deep: #151520;          /* Deep stellar */
  --stellar-dark: #222233;          /* Dark stellar */
  --stellar-medium: #333344;        /* Medium stellar */
  --stellar-light: #556677;         /* Light stellar */
  --stellar-lighter: #778899;       /* Lighter stellar */
  --stellar-bright: #99AABB;        /* Bright stellar */
  --stellar-lightest: #BBCCDD;      /* Lightest stellar */
  
  /* Cosmic Accent Colors */
  --cosmic-ice: #E6F3FF;            /* Ice blue */
  --cosmic-frost: #CCE7FF;          /* Frost blue */
  --cosmic-crystal: #B3DAFF;        /* Crystal blue */
  --cosmic-glow: #80CCFF;           /* Glow blue */
  --cosmic-energy: #4DB8FF;         /* Energy blue */
  --cosmic-plasma: #1AA3FF;         /* Plasma blue */
  
  /* Neutral Space Tones */
  --space-silver: #C5D1E0;          /* Silver tone */
  --space-mist: #A8B8CC;           /* Space mist */
  --space-dust: #8A9BB5;           /* Space dust */
  --space-nebula: #6D8099;         /* Nebula tone */
  
  /* Alert & Status Colors (space-themed) */
  --alert-danger: #FF6B6B;          /* Supernova red */
  --alert-warning: #FFD93D;         /* Solar flare yellow */
  --alert-success: #6BCF7F;         /* Nebula green */
  --alert-info: var(--cosmic-energy);/* Info blue */
  
  /* === BACKGROUND SYSTEM === */
  --bg-primary: var(--cosmic-void);
  --bg-secondary: var(--cosmic-abyss);
  --bg-tertiary: var(--space-deep);
  --bg-quaternary: var(--space-darker);
  --bg-overlay: rgba(0, 17, 34, 0.85);
  --bg-overlay-light: rgba(0, 34, 68, 0.75);
  --bg-glass: rgba(0, 68, 136, 0.15);
  --bg-glass-strong: rgba(0, 68, 136, 0.25);
  
  /* === TEXT SYSTEM === */
  --text-primary: var(--cosmic-ice);
  --text-secondary: var(--space-silver);
  --text-tertiary: var(--space-mist);
  --text-accent: var(--cosmic-glow);
  --text-muted: var(--space-dust);
  --text-dim: var(--stellar-light);
  --text-bright: #FFFFFF;
  --text-link: var(--cosmic-energy);
  --text-link-hover: var(--cosmic-glow);
  --text-heading: var(--cosmic-frost);
  
  /* === BORDER SYSTEM === */
  --border-primary: rgba(128, 204, 255, 0.2);
  --border-secondary: rgba(128, 204, 255, 0.15);
  --border-accent: rgba(128, 204, 255, 0.4);
  --border-subtle: rgba(85, 102, 119, 0.3);
  --border-strong: rgba(128, 204, 255, 0.6);
  
  /* === SHADOW SYSTEM === */
  --shadow-sm: 0 2px 8px rgba(0, 5, 17, 0.3);
  --shadow-md: 0 4px 16px rgba(0, 5, 17, 0.4);
  --shadow-lg: 0 8px 32px rgba(0, 5, 17, 0.5);
  --shadow-xl: 0 16px 48px rgba(0, 5, 17, 0.6);
  --shadow-glow: 0 0 24px rgba(128, 204, 255, 0.2);
  --shadow-glow-strong: 0 0 32px rgba(128, 204, 255, 0.3);
  
  /* === GRADIENTS === */
  --gradient-cosmic: linear-gradient(135deg, var(--cosmic-void) 0%, var(--space-deep) 50%, var(--space-darker) 100%);
  --gradient-stellar: linear-gradient(180deg, var(--stellar-void) 0%, var(--stellar-dark) 100%);
  --gradient-nebula: radial-gradient(ellipse at center, var(--space-darker) 0%, var(--cosmic-void) 70%);
  --gradient-aurora: linear-gradient(90deg, var(--cosmic-energy) 0%, var(--cosmic-glow) 50%, var(--cosmic-crystal) 100%);
  --gradient-glass: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
  
  /* === TYPOGRAPHY === */
  --font-primary: 'Inter', 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
  --font-heading: 'Space Grotesk', 'Segoe UI', sans-serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Courier New', monospace;
  
  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-md: 1.125rem;
  --font-size-lg: 1.25rem;
  --font-size-xl: 1.5rem;
  --font-size-2xl: 2rem;
  --font-size-3xl: 2.5rem;
  --font-size-4xl: 3rem;
  
  --line-height-tight: 1.25;
  --line-height-base: 1.6;
  --line-height-loose: 1.8;
  
  --font-weight-light: 300;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;
  
  /* === SPACING & LAYOUT === */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;
  --space-3xl: 4rem;
  
  --content-width: 800px;        /* Wider content as requested */
  --content-width-wide: 1000px;
  --sidebar-width: 280px;
  --navbar-height: 64px;
  
  /* === BORDER RADIUS === */
  --radius-sm: 6px;
  --radius-md: 12px;
  --radius-lg: 16px;
  --radius-xl: 24px;
  --radius-full: 50px;
  
  /* === TRANSITIONS === */
  --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-base: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  
  /* === BACKDROP FILTERS === */
  --blur-sm: blur(4px);
  --blur-md: blur(8px);
  --blur-lg: blur(12px);
  --blur-xl: blur(16px);
}

// =====================================================================
// 2. GLOBAL RESET & BASE STYLES
// =====================================================================

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
  font-size: 16px;
}

body {
  font-family: var(--font-primary);
  font-size: var(--font-size-base);
  line-height: var(--line-height-base);
  color: var(--text-primary);
  background: var(--gradient-cosmic);
  background-attachment: fixed;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  overflow-x: hidden;
  
  &::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: var(--gradient-nebula);
    z-index: -2;
  }
  
  &::after {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
      radial-gradient(2px 2px at 20% 30%, var(--cosmic-glow), transparent),
      radial-gradient(2px 2px at 40% 70%, var(--cosmic-energy), transparent),
      radial-gradient(1px 1px at 90% 40%, var(--cosmic-crystal), transparent),
      radial-gradient(1px 1px at 60% 10%, var(--space-silver), transparent);
    background-size: 800px 800px;
    animation: starfield 120s linear infinite;
    opacity: 0.6;
    z-index: -1;
  }
}

@keyframes starfield {
  0% { transform: translate(0, 0); }
  100% { transform: translate(-800px, -800px); }
}

::selection {
  background: var(--bg-glass-strong);
  color: var(--text-bright);
}

// =====================================================================
// 3. TYPOGRAPHY
// =====================================================================

h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-heading);
  font-weight: var(--font-weight-bold);
  line-height: var(--line-height-tight);
  color: var(--text-heading);
  margin-bottom: var(--space-md);
  letter-spacing: -0.025em;
}

h1 {
  font-size: var(--font-size-3xl);
  background: var(--gradient-aurora);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 30px rgba(128, 204, 255, 0.5);
  margin-bottom: var(--space-lg);
}

h2 {
  font-size: var(--font-size-2xl);
  color: var(--cosmic-frost);
  margin-top: var(--space-2xl);
}

h3 {
  font-size: var(--font-size-xl);
  color: var(--cosmic-crystal);
  margin-top: var(--space-xl);
}

h4 {
  font-size: var(--font-size-lg);
  color: var(--space-silver);
}

p {
  margin-bottom: var(--space-md);
  line-height: var(--line-height-loose);
}

strong {
  color: var(--cosmic-glow);
  font-weight: var(--font-weight-semibold);
}

em {
  color: var(--space-silver);
  font-style: italic;
}

// =====================================================================
// 4. LINKS
// =====================================================================

a {
  color: var(--text-link);
  text-decoration: none;
  position: relative;
  transition: all var(--transition-base);
  
  &::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--cosmic-energy), var(--cosmic-glow));
    transition: width var(--transition-base);
  }
  
  &:hover {
    color: var(--text-link-hover);
    text-shadow: 0 0 8px rgba(128, 204, 255, 0.4);
    
    &::after {
      width: 100%;
    }
  }
  
  &.internal-link {
    color: var(--cosmic-glow);
    
    &:hover {
      color: var(--cosmic-crystal);
    }
  }
}

// =====================================================================
// 5. MAIN LAYOUT
// =====================================================================

.container {
  display: flex;
  min-height: 100vh;
  max-width: 100%;
}

// =====================================================================
// 6. NAVBAR
// =====================================================================

.navbar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: var(--navbar-height);
  background: var(--bg-overlay);
  backdrop-filter: var(--blur-lg);
  border-bottom: 1px solid var(--border-secondary);
  z-index: 1000;
  
  .navbar-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    padding: 0 var(--space-lg);
    max-width: 1400px;
    margin: 0 auto;
  }
  
  .navbar-brand {
    font-family: var(--font-heading);
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-bold);
    color: var(--cosmic-glow);
    text-decoration: none;
    
    &:hover {
      color: var(--cosmic-crystal);
      text-shadow: 0 0 12px rgba(128, 204, 255, 0.4);
    }
  }
  
  .navbar-nav {
    display: flex;
    align-items: center;
    gap: var(--space-lg);
    
    a {
      color: var(--text-secondary);
      font-weight: var(--font-weight-medium);
      padding: var(--space-sm) var(--space-md);
      border-radius: var(--radius-md);
      transition: all var(--transition-base);
      
      &:hover {
        background: var(--bg-glass);
        color: var(--text-primary);
        box-shadow: var(--shadow-glow);
      }
      
      &::after {
        display: none;
      }
    }
  }
}

// =====================================================================
// 7. SIDEBAR (FILE TREE)
// =====================================================================

.filetree-sidebar {
  position: fixed;
  top: var(--navbar-height);
  left: 0;
  width: var(--sidebar-width);
  height: calc(100vh - var(--navbar-height));
  background: var(--bg-overlay);
  backdrop-filter: var(--blur-md);
  border-right: 1px solid var(--border-secondary);
  overflow-y: auto;
  z-index: 100;
  padding: var(--space-lg);
  
  h1 {
    font-size: var(--font-size-lg);
    margin-bottom: var(--space-lg);
    padding-bottom: var(--space-md);
    border-bottom: 1px solid var(--border-subtle);
  }
  
  .filetree {
    ul {
      list-style: none;
      padding-left: var(--space-md);
    }
    
    li {
      margin-bottom: var(--space-sm);
      
      &:first-child {
        padding-left: 0;
      }
    }
    
    a {
      display: block;
      padding: var(--space-xs) var(--space-sm);
      border-radius: var(--radius-sm);
      color: var(--text-tertiary);
      font-size: var(--font-size-sm);
      transition: all var(--transition-fast);
      
      &:hover {
        background: var(--bg-glass);
        color: var(--text-primary);
        transform: translateX(4px);
      }
      
      &.active,
      &[aria-current="page"] {
        background: var(--bg-glass-strong);
        color: var(--cosmic-glow);
        box-shadow: var(--shadow-glow);
      }
      
      &::after {
        display: none;
      }
    }
    
    .folder {
      font-weight: var(--font-weight-medium);
      color: var(--text-secondary);
      margin-bottom: var(--space-sm);
      
      &::before {
        content: '📁 ';
        margin-right: var(--space-xs);
      }
    }
  }
}

// =====================================================================
// 8. CONTENT AREA
// =====================================================================

.content {
  margin-left: var(--sidebar-width);
  margin-top: var(--navbar-height);
  padding: var(--space-2xl) var(--space-xl);
  max-width: calc(var(--content-width) + var(--sidebar-width));
  width: 100%;
  min-height: calc(100vh - var(--navbar-height));
  
  // Center the content within its container
  .content-inner {
    max-width: var(--content-width);
    margin: 0 auto;
  }
}

// =====================================================================
// 9. RIGHT SIDEBAR (GRAPH, BACKLINKS, TOC)
// =====================================================================

.sidebar {
  position: fixed;
  top: var(--navbar-height);
  right: 0;
  width: var(--sidebar-width);
  height: calc(100vh - var(--navbar-height));
  background: var(--bg-overlay);
  backdrop-filter: var(--blur-md);
  border-left: 1px solid var(--border-secondary);
  padding: var(--space-lg);
  overflow-y: auto;
  z-index: 100;
  
  .sidebar-section {
    margin-bottom: var(--space-2xl);
    
    h3 {
      font-size: var(--font-size-md);
      color: var(--text-heading);
      margin-bottom: var(--space-md);
      padding-bottom: var(--space-sm);
      border-bottom: 1px solid var(--border-subtle);
    }
  }
  
  .toc {
    ul {
      list-style: none;
      padding-left: var(--space-md);
    }
    
    a {
      display: block;
      padding: var(--space-xs) var(--space-sm);
      font-size: var(--font-size-sm);
      color: var(--text-muted);
      border-radius: var(--radius-sm);
      
      &:hover {
        background: var(--bg-glass);
        color: var(--text-primary);
      }
      
      &::after {
        display: none;
      }
    }
  }
  
  .backlinks {
    .backlink-item {
      padding: var(--space-sm);
      margin-bottom: var(--space-sm);
      background: var(--bg-glass);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-subtle);
      
      a {
        font-weight: var(--font-weight-medium);
        color: var(--cosmic-energy);
        
        &:hover {
          color: var(--cosmic-glow);
        }
      }
      
      .context {
        font-size: var(--font-size-xs);
        color: var(--text-muted);
        margin-top: var(--space-xs);
      }
    }
  }
  
  .graph {
    #link-graph {
      width: 100%;
      height: 300px;
      border-radius: var(--radius-lg);
      background: var(--bg-glass);
      border: 1px solid var(--border-secondary);
    }
  }
}

// =====================================================================
// 10. SEARCH
// =====================================================================

.search-container {
  position: relative;
  
  .search-input {
    width: 100%;
    padding: var(--space-md);
    background: var(--bg-glass);
    border: 1px solid var(--border-secondary);
    border-radius: var(--radius-lg);
    color: var(--text-primary);
    font-size: var(--font-size-md);
    backdrop-filter: var(--blur-md);
    
    &::placeholder {
      color: var(--text-muted);
    }
    
    &:focus {
      outline: none;
      border-color: var(--border-accent);
      box-shadow: var(--shadow-glow);
    }
  }
  
  .search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--bg-overlay);
    backdrop-filter: var(--blur-lg);
    border: 1px solid var(--border-secondary);
    border-radius: var(--radius-lg);
    margin-top: var(--space-xs);
    max-height: 400px;
    overflow-y: auto;
    z-index: 1000;
    
    .search-result {
      padding: var(--space-md);
      border-bottom: 1px solid var(--border-subtle);
      
      &:hover {
        background: var(--bg-glass);
      }
      
      &:last-child {
        border-bottom: none;
      }
      
      .result-title {
        font-weight: var(--font-weight-medium);
        color: var(--cosmic-glow);
        margin-bottom: var(--space-xs);
      }
      
      .result-excerpt {
        font-size: var(--font-size-sm);
        color: var(--text-tertiary);
      }
    }
  }
}

// =====================================================================
// 11. CONTENT ELEMENTS
// =====================================================================

// Blockquotes
blockquote {
  padding: var(--space-lg);
  margin: var(--space-lg) 0;
  background: var(--bg-glass);
  border-left: 4px solid var(--cosmic-energy);
  border-radius: var(--radius-md);
  font-style: italic;
  color: var(--text-secondary);
  backdrop-filter: var(--blur-sm);
  
  p:last-child {
    margin-bottom: 0;
  }
}

// Lists
ul, ol {
  padding-left: var(--space-xl);
  margin-bottom: var(--space-lg);
  
  li {
    margin-bottom: var(--space-sm);
    line-height: var(--line-height-loose);
    
    &::marker {
      color: var(--cosmic-glow);
    }
  }
}

// Code
code {
  font-family: var(--font-mono);
  font-size: 0.9em;
  background: var(--stellar-dark);
  color: var(--cosmic-ice);
  padding: var(--space-xs) var(--space-sm);
  border-radius: var(--radius-sm);
  border: 1px solid var(--border-subtle);
}

pre {
  background: var(--stellar-void);
  color: var(--cosmic-ice);
  padding: var(--space-lg);
  border-radius: var(--radius-lg);
  overflow-x: auto;
  margin: var(--space-lg) 0;
  border: 1px solid var(--border-secondary);
  box-shadow: var(--shadow-md);
  
  code {
    background: transparent;
    padding: 0;
    border: none;
  }
}

// Tables
table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  margin: var(--space-lg) 0;
  background: var(--bg-glass);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-md);
  backdrop-filter: var(--blur-sm);
  
  th, td {
    padding: var(--space-md);
    text-align: left;
    border-bottom: 1px solid var(--border-subtle);
  }
  
  thead {
    th {
      background: var(--bg-glass-strong);
      font-weight: var(--font-weight-semibold);
      color: var(--text-heading);
      border-bottom: 2px solid var(--border-accent);
    }
  }
  
  tbody {
    tr {
      &:hover {
        background: var(--bg-glass);
      }
      
      &:last-child {
        td {
          border-bottom: none;
        }
      }
    }
  }
}

// Images
img {
  max-width: 100%;
  height: auto;
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-lg);
  margin: var(--space-lg) 0;
}

// Callouts
.callout {
  padding: var(--space-lg);
  margin: var(--space-lg) 0;
  background: var(--bg-glass);
  backdrop-filter: var(--blur-sm);
  border-radius: var(--radius-lg);
  border-left: 4px solid var(--cosmic-energy);
  position: relative;
  overflow: hidden;
  
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--gradient-glass);
    pointer-events: none;
  }
  
  .callout-title {
    font-weight: var(--font-weight-semibold);
    color: var(--text-heading);
    margin-bottom: var(--space-sm);
    display: flex;
    align-items: center;
    gap: var(--space-sm);
  }
  
  &.note {
    border-left-color: var(--cosmic-energy);
  }
  
  &.warning {
    border-left-color: var(--alert-warning);
  }
  
  &.important {
    border-left-color: var(--alert-danger);
  }
  
  &.tip {
    border-left-color: var(--alert-success);
  }
}

// =====================================================================
// 12. SCROLLBAR
// =====================================================================

::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--bg-secondary);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--cosmic-energy), var(--cosmic-glow));
  border-radius: var(--radius-full);
  border: 2px solid var(--bg-secondary);
  
  &:hover {
    background: linear-gradient(180deg, var(--cosmic-glow), var(--cosmic-crystal));
  }
}

// Firefox scrollbar
* {
  scrollbar-width: thin;
  scrollbar-color: var(--cosmic-energy) var(--bg-secondary);
}

// =====================================================================
// 13. RESPONSIVE DESIGN
// =====================================================================

@media (max-width: 1200px) {
  .content {
    margin-right: var(--sidebar-width);
    max-width: calc(100vw - var(--sidebar-width) * 2);
  }
}

@media (max-width: 968px) {
  .filetree-sidebar,
  .sidebar {
    transform: translateX(-100%);
    transition: transform var(--transition-base);
    
    &.active {
      transform: translateX(0);
    }
  }
  
  .sidebar {
    transform: translateX(100%);
  }
  
  .content {
    margin-left: 0;
    margin-right: 0;
    max-width: 100%;
    padding: var(--space-xl) var(--space-lg);
    
    .content-inner {
      max-width: none;
    }
  }
  
  .navbar-nav {
    display: none;
  }
}

@media (max-width: 640px) {
  .content {
    padding: var(--space-lg) var(--space-md);
  }
  
  .navbar {
    .navbar-inner {
      padding: 0 var(--space-md);
    }
  }
  
  h1 {
    font-size: var(--font-size-2xl);
  }
  
  h2 {
    font-size: var(--font-size-xl);
  }
}
// =====================================================================
// 14. Floating shortcut buttons
// =====================================================================
.floating-buttons {
  position: fixed;
  bottom: 20px;
  left: 20px;
  display: flex;
  flex-direction: row; /* inline, side by side */
  gap: 12px; /* space between buttons */
  z-index: 9999;
}

.floating-buttons img {
  width: 32px;   /* smaller size */
  height: 32px;
  cursor: pointer;
  border-radius: 8px; /* soft rounded corners (optional) */
  transition: transform 0.25s ease, filter 0.25s ease;
}

.floating-buttons img:hover {
  transform: scale(1.2) rotate(-3deg); /* grow + slight tilt */
  filter: brightness(1.2); /* subtle glow effect */
}

// =====================================================================
// 15. Digital Garden — Fullscreen & Theatre Mode
// =====================================================================

/* ============================================================
   FULL REPLACEMENT: Fullscreen (focus) + Theatre (cinema)
   - Responsive YouTube embed fixes (CSS + .video-wrapper)
   - Theatre darkening only when active
   - Does not alter fonts/headers outside fullscreen
   ============================================================ */

/* -------------------------
   Button (top-right)
   ------------------------- */
.fullscreen-btn {
  position: fixed;
  top: 20px;
  right: 20px;
  background: linear-gradient(135deg, var(--text-accent, #667eea) 0%, #764ba2 100%);
  border: none;
  color: white;
  padding: 12px 18px;
  border-radius: 24px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  transition: all 0.28s cubic-bezier(0.4,0,0.2,1);
  box-shadow: 0 6px 24px rgba(0,0,0,.28);
  z-index: 10010;
}
.fullscreen-btn:hover { transform: translateY(-2px); }
.fullscreen-btn svg { width: 18px; height: 18px; }

/* duplicate-style for second button (theatre) but hidden until fullscreen */
.fullscreen-btn.theatre-toggle { top: 64px; display: none; }

/* -------------------------
   Generic transition targets
   ------------------------- */
.navbar, .filetree-sidebar, .sidebar, .content, .fullscreen-btn {
  transition: all 0.32s cubic-bezier(0.4,0,0.2,1);
}

/* ============================================================
   FULLSCREEN MODE — scoped to body.fullscreen-mode
   (does NOT change fonts/headers outside fullscreen)
   ============================================================ */
body.fullscreen-mode {
  /* Hide side UI elements comprehensively */
  nav, header, footer, aside,
  .navbar, .filetree-sidebar, .sidebar, .site-sidebar, .left-panel,
  .search-container, .site-nav, .graph-container, .local-graph, .global-graph,
  .toc, .table-of-contents, .backlinks, .file-tree {
    opacity: 0 !important;
    pointer-events: none !important;
    display: none !important;
  }

  /* Button tweak for visual prominence */
  .fullscreen-btn {
    top: 28px;
    right: 28px;
    transform: scale(1.05);
    z-index: 10010;
  }
  .fullscreen-btn.theatre-toggle { display: inline-flex; }

  /* Widen & center note content while preserving vertical proportions */
  .content {
    max-width: 95vw !important;
    margin: 0 auto !important;
    padding: 8vh 2.5vw !important;
    min-height: 100vh;
    display: block;
    box-sizing: border-box;
  }

  /* Keep typography as-is (no forcing fonts) but scale sensible base size */
  .content, .content p, .content li {
    font-size: clamp(16px, 0.9vw + 14px, 20px);
    line-height: 1.65;
  }

  /* Media and embeds scale to use full width */
  .content img,
  .content video,
  .content embed,
  .content iframe,
  .content .markdown-embed,
  .content .embed,
  .content .embed-iframe {
    max-width: 100% !important;
    width: 100% !important;
    height: auto !important;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  /* Excalidraw / canvas embeds: keep minimum heights to avoid collapse */
  .content .excalidraw-embed,
  .content .excalidraw-container {
    width: 100% !important;
    min-height: 60vh !important;
  }
}

/* Fullscreen API support (when using requestFullscreen on .content) */
.content:fullscreen,
:fullscreen .content {
  max-width: 95vw !important;
  margin: 0 auto;
  padding: 8vh 2vw;
}

/* ============================================================
   RESPONSIVE YOUTUBE / IFRAME FIXES
   - primary solution: CSS aspect-ratio
   - fallback: JS wraps YouTube iframes into .video-wrapper (see note.njk)
   ============================================================ */

/* Preferred: if browser supports aspect-ratio — keep it simple */
.content iframe[src*="youtube.com"],
.content iframe[src*="youtu.be"],
.content iframe[src*="youtube-nocookie"] {
  width: 100% !important;
  max-width: 100% !important;
  height: auto !important;
  aspect-ratio: 16 / 9;
  display: block;
  border: 0;
  border-radius: 12px;
}

/* Also ensure markdown-embed containers don't constrain height */
.content .markdown-embed,
.content .embed {
  width: 100% !important;
  max-width: 100% !important;
}

/* Classic fallback wrapper styling (used by JS if needed) */
.video-wrapper {
  position: relative;
  width: 100%;
  max-width: 100%;
  padding-top: 56.25%; /* 16:9 ratio */
  height: 0;
  overflow: hidden;
  border-radius: 12px;
}
.video-wrapper iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100% !important;
  height: 100% !important;
  border: 0;
  display: block;
}

/* Ensure youtube picture-in-picture or fullscreen controls still work */
.content iframe[allowfullscreen] { /* no-op, but explicit for readability */ }

/* ============================================================
   THEATRE MODE — applied strictly when body.theatre-mode exists
   - fully black background (hides particles/starfield)
   - cinematic side lights that are purely decorative
   - vignette + grain optional
   ============================================================ */
body.theatre-mode {
  background: #000 !important;
  overflow-y: auto;
}

/* Side cinematic glow: only present when theatre-mode enabled */
body.theatre-mode::before,
body.theatre-mode::after {
  content: "";
  position: fixed;
  top: 0; bottom: 0;
  width: 18vw;
  z-index: 998;
  pointer-events: none;
  background: radial-gradient(circle at 40% 50%,
    rgba(255,180,120,0.12) 0%,
    rgba(0,0,0,0) 50%),
    radial-gradient(circle at 60% 50%,
    rgba(140,180,255,0.06) 0%,
    rgba(0,0,0,0) 60%);
  filter: blur(56px);
  transition: opacity 420ms ease;
  opacity: 1;
}
body.theatre-mode::before { left: 0; }
body.theatre-mode::after  { right: 0; }

/* Screen focus (the note) in theatre mode */
body.theatre-mode .content {
  max-width: 86vw !important;
  margin: 4vh auto !important;
  background: #0f0f10;
  border-radius: 12px;
  padding: 3.5rem 4.5rem;
  color: #eaeaea;
  box-shadow:
    0 40px 120px rgba(0,0,0,0.95),
    0 0 140px rgba(0,0,0,0.9) inset;
  transition: all 420ms ease;
}

/* subtle vignette and film grain: only visible in theatre mode */
.theatre-vignette {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 999;
  background: radial-gradient(ellipse at center, rgba(0,0,0,0) 68%, rgba(0,0,0,0.9) 100%);
  opacity: 1;
}
.theatre-grain {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 9999;
  background-image:
    repeating-linear-gradient(0deg, rgba(255,255,255,0.35) 0 1px, transparent 1px 2px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.18) 0 1px, transparent 1px 2px);
  mix-blend-mode: overlay;
  opacity: 0.03;
}

/* Print safety */
@media print {
  .fullscreen-btn, .theatre-vignette, .theatre-grain, body.theatre-mode::before, body.theatre-mode::after {
    display: none !important;
  }
}
