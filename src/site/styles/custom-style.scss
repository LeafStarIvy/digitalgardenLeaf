/*
 * STELLAR KNOWLEDGE GARDEN
 * A modular, performance-optimized cosmic theme with advanced visual effects,
 * accessibility improvements, and responsive design principles
 */

// =========================================================================
// FOUNDATION: Design Tokens
// =========================================================================

:root {
  // COLOR SYSTEM
  // Core palette based on spectral analysis of nebulae and galaxies
  
  // Deep space colors - carefully calibrated luminance progression
  --space-00: #010203; // Void
  --space-05: #020508; // Abyss
  --space-10: #03070E; // Deep space void
  --space-20: #05101C; // Cosmic background
  --space-30: #071527; // Deep space
  --space-40: #0A1A32; // Space
  --space-50: #0E224A; // Upper atmosphere
  
  // Mid-tones with proper contrast ratios
  --space-60: #172C57; // Twilight
  --space-70: #213A6C; // Dusk
  --space-80: #2E4C89; // Evening
  --space-90: #3B5CA0; // Upper night
  
  // Light tones with smooth progression
  --space-100: #4B70BC; // Night
  --space-200: #6389D3; // Dawn
  --space-300: #8BA8E2; // Morning
  --space-400: #B1C7F0; // Day
  --space-500: #D4E2FF; // Light
  
  // Aurora spectrum with proper RGB profiles
  // Each has consistent saturation/luminance relationships
  
  // Cyan family (water, technology, calm)
  --cyan-900: #024B56;
  --cyan-800: #056774;
  --cyan-700: #07828E;
  --cyan-600: #0A9EAC;
  --cyan-500: #0CBFCF;
  --cyan-400: #2FD6E5;
  --cyan-300: #64E4F0;
  --cyan-200: #A0F0F7;
  --cyan-100: #CFFAFD;
  
  // Purple family (creativity, mystery, imagination)
  --purple-900: #341368;
  --purple-800: #4A1C94;
  --purple-700: #6026BF;
  --purple-600: #7433E0;
  --purple-500: #8A4DF8;
  --purple-400: #A172FA;
  --purple-300: #B797FC;
  --purple-200: #D1BDFD;
  --purple-100: #EBE3FE;
  
  // Emerald family (growth, nature, wisdom)
  --emerald-900: #064E3B;
  --emerald-800: #065F46;
  --emerald-700: #047857;
  --emerald-600: #059669;
  --emerald-500: #10B981;
  --emerald-400: #34D399;
  --emerald-300: #6EE7B7;
  --emerald-200: #A7F3D0;
  --emerald-100: #D1FAE5;
  
  // Rose family (energy, passion, alerts)
  --rose-900: #881337;
  --rose-800: #9F1239;
  --rose-700: #BE123C;
  --rose-600: #E11D48;
  --rose-500: #F43F5E;
  --rose-400: #FB7185;
  --rose-300: #FDA4AF;
  --rose-200: #FECDD3;
  --rose-100: #FFE4E6;
  
  // Amber family (caution, attention, warmth)
  --amber-900: #78350F;
  --amber-800: #92400E;
  --amber-700: #B45309;
  --amber-600: #D97706;
  --amber-500: #F59E0B;
  --amber-400: #FBBF24;
  --amber-300: #FCD34D;
  --amber-200: #FDE68A;
  --amber-100: #FEF3C7;
  
  // FUNCTIONAL COLOR ASSIGNMENTS
  // Semantic assignments with consistent contrast ratios
  
  // Background layers - progressive depth
  --bg-deepest: var(--space-05);
  --bg-deeper: var(--space-10);
  --bg-deep: var(--space-20);
  --bg-base: var(--space-30);
  --bg-raised: var(--space-40);
  --bg-elevated: var(--space-50);
  --bg-floating: var(--space-60);
  
  // Surface treatments
  --surface-subtle: rgba(255, 255, 255, 0.04);
  --surface-regular: rgba(255, 255, 255, 0.08);
  --surface-strong: rgba(255, 255, 255, 0.12);
  --surface-bold: rgba(255, 255, 255, 0.16);
  
  // Text colors - AA/AAA compliant contrast ratios
  --text-brightest: var(--space-500);
  --text-bright: var(--space-400);
  --text-base: var(--space-300);
  --text-muted: var(--space-200);
  --text-dim: var(--space-100);
  
  // Accent colors - semantic application
  --accent-primary: var(--cyan-400);
  --accent-primary-muted: var(--cyan-600);
  --accent-primary-subtle: var(--cyan-800);
  --accent-secondary: var(--purple-400);
  --accent-secondary-muted: var(--purple-600);
  --accent-secondary-subtle: var(--purple-800);
  
  // State colors - feedback and interactions
  --state-info: var(--cyan-400);
  --state-success: var(--emerald-400);
  --state-warning: var(--amber-400);
  --state-danger: var(--rose-400);
  --state-info-subtle: var(--cyan-900);
  --state-success-subtle: var(--emerald-900);
  --state-warning-subtle: var(--amber-900);
  --state-danger-subtle: var(--rose-900);
  
  // GRADIENTS
  // Properly constructed with perceptually uniform color steps
  
  --gradient-cosmic: linear-gradient(
    135deg,
    var(--space-10),
    var(--space-30) 25%,
    var(--space-40) 60%,
    var(--space-50)
  );
  
  --gradient-aurora: linear-gradient(
    to right,
    var(--purple-500),
    var(--cyan-500)
  );
  
  --gradient-nebula: radial-gradient(
    circle at center,
    var(--purple-400) 0%,
    var(--purple-600) 30%,
    var(--space-40) 70%
  );
  
  --gradient-glow-cyan: linear-gradient(
    135deg,
    var(--cyan-900),
    var(--cyan-600)
  );
  
  --gradient-glow-purple: linear-gradient(
    135deg,
    var(--purple-900),
    var(--purple-600)
  );

  // EFFECTS
  // Glass morphism and visual treatments
  
  --glass-regular: rgba(11, 26, 50, 0.8);
  --glass-medium: rgba(13, 31, 57, 0.7);
  --glass-light: rgba(15, 35, 65, 0.6);
  --glass-blur: blur(12px);
  
  // Glow effects
  --glow-subtle: 0 0 15px rgba(14, 165, 233, 0.1);
  --glow-medium: 0 0 25px rgba(14, 165, 233, 0.2);
  --glow-strong: 0 0 35px rgba(14, 165, 233, 0.3);
  --glow-purple: 0 0 20px rgba(138, 77, 248, 0.25);
  --glow-cyan: 0 0 20px rgba(12, 191, 207, 0.25);
  
  // Shadows for proper depth perception
  --shadow-subtle: 0 2px 4px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
  --shadow-regular: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-medium: 0 10px 15px rgba(0, 0, 0, 0.1), 0 4px 6px rgba(0, 0, 0, 0.05);
  --shadow-strong: 0 20px 25px rgba(0, 0, 0, 0.1), 0 10px 10px rgba(0, 0, 0, 0.04);
  --shadow-intense: 0 25px 50px rgba(0, 0, 0, 0.15), 0 15px 20px rgba(0, 0, 0, 0.1);
  
  // TYPOGRAPHY
  // Systematic, accessible font scale with proper ratios
  
  // Font family declarations
  --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  --font-heading: 'Space Grotesk', 'Manrope', var(--font-sans);
  --font-mono: 'JetBrains Mono', 'Fira Code', 'Roboto Mono', monospace;
  
  // Font sizes - 1.2 ratio type scale
  --text-xs: 0.75rem;    // 12px
  --text-sm: 0.875rem;   // 14px
  --text-base: 1rem;     // 16px
  --text-md: 1.125rem;   // 18px
  --text-lg: 1.25rem;    // 20px
  --text-xl: 1.5rem;     // 24px
  --text-2xl: 1.75rem;   // 28px
  --text-3xl: 2rem;      // 32px
  --text-4xl: 2.5rem;    // 40px
  --text-5xl: 3rem;      // 48px
  --text-6xl: 3.75rem;   // 60px
  
  // Line heights - contextual
  --leading-none: 1;
  --leading-tight: 1.2;
  --leading-snug: 1.35;
  --leading-normal: 1.5;
  --leading-relaxed: 1.625;
  --leading-loose: 1.75;
  
  // Font weights - standard scale
  --weight-light: 300;
  --weight-normal: 400;
  --weight-medium: 500;
  --weight-semibold: 600;
  --weight-bold: 700;
  
  // Letter spacing - subtle adjustments
  --tracking-tighter: -0.05em;
  --tracking-tight: -0.025em;
  --tracking-normal: 0;
  --tracking-wide: 0.025em;
  --tracking-wider: 0.05em;
  --tracking-widest: 0.1em;
  
  // LAYOUT
  // Consistent spacing system and layout variables
  
  // Base spacing units
  --space-1: 0.25rem;   // 4px
  --space-2: 0.5rem;    // 8px
  --space-3: 0.75rem;   // 12px
  --space-4: 1rem;      // 16px
  --space-5: 1.25rem;   // 20px
  --space-6: 1.5rem;    // 24px
  --space-8: 2rem;      // 32px
  --space-10: 2.5rem;   // 40px
  --space-12: 3rem;     // 48px
  --space-16: 4rem;     // 64px
  --space-20: 5rem;     // 80px
  --space-24: 6rem;     // 96px
  
  // Layout metrics
  --content-width: 42rem;        // 672px - optimal reading width
  --content-width-wide: 64rem;   // 1024px
  --sidebar-width: 18rem;        // 288px
  --sidebar-collapsed: 4rem;     // 64px
  --header-height: 3.5rem;       // 56px
  --footer-height: 3.5rem;       // 56px
  --page-padding: clamp(1rem, 5vw, 2rem);
  
  // BORDERS
  // Consistent border system
  
  --radius-sm: 0.25rem;  // 4px
  --radius-md: 0.375rem; // 6px
  --radius-lg: 0.5rem;   // 8px
  --radius-xl: 0.75rem;  // 12px
  --radius-2xl: 1rem;    // 16px
  --radius-full: 9999px;
  
  --border-thin: 1px;
  --border-regular: 2px;
  --border-thick: 3px;
  
  // ANIMATIONS
  // Custom animation system
  
  --transition-fast: 150ms;
  --transition-normal: 250ms;
  --transition-slow: 350ms;
  --transition-very-slow: 500ms;
  
  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
  --ease-in: cubic-bezier(0.4, 0, 1, 1);
  --ease-out: cubic-bezier(0, 0, 0.2, 1);
  --ease-bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  
  // EFFECTS
  // Visual elements that form the cosmic background
  
  --star-opacity: 0.65;
  --nebula-opacity: 0.25;
  --aurora-opacity: 0.15;
  --grain-opacity: 0.035;
}

// =========================================================================
// CORE: Base Elements
// =========================================================================

// Global reset and base styles
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  // Enable smooth scrolling
  scroll-behavior: smooth;
  // Prevent text size adjustment on orientation change
  -webkit-text-size-adjust: 100%;
}

body {
  // Base background and typography
  background-color: var(--bg-deepest);
  color: var(--text-base);
  font-family: var(--font-sans);
  font-size: var(--text-base);
  line-height: var(--leading-normal);
  overflow-x: hidden;
  
  // High-quality text rendering
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  
  // System-level dark mode support
  color-scheme: dark;
  
  // Set up selection styling
  ::selection {
    background-color: var(--accent-primary-subtle);
    color: var(--text-brightest);
  }
}

// Content structure enhancements
main {
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  max-width: var(--content-width-wide);
  margin: 0 auto;
  padding: var(--space-6) var(--page-padding);
  position: relative;
  z-index: 1;
}

// =========================================================================
// COMPONENTS: Common Elements
// =========================================================================

// Heading styles
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-heading);
  font-weight: var(--weight-semibold);
  line-height: var(--leading-tight);
  letter-spacing: var(--tracking-tight);
  color: var(--text-brightest);
  margin-bottom: var(--space-4);
  
  // Add subtle glow to headings
  text-shadow: var(--glow-subtle);
}

h1 {
  font-size: var(--text-4xl);
  margin-bottom: var(--space-6);
  background: var(--gradient-aurora);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  
  // Enhance large headings with stronger glow
  text-shadow: var(--glow-medium);
}

h2 {
  font-size: var(--text-3xl);
  margin-top: var(--space-8);
  border-bottom: var(--border-thin) solid var(--surface-subtle);
  padding-bottom: var(--space-2);
}

h3 {
  font-size: var(--text-2xl);
  margin-top: var(--space-6);
  color: var(--accent-primary);
}

h4 {
  font-size: var(--text-xl);
  margin-top: var(--space-5);
}

h5 {
  font-size: var(--text-lg);
  margin-top: var(--space-4);
}

h6 {
  font-size: var(--text-md);
  margin-top: var(--space-3);
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

// Paragraph and text elements
p {
  margin-bottom: var(--space-4);
  
  &:last-child {
    margin-bottom: 0;
  }
}

strong, b {
  font-weight: var(--weight-semibold);
  color: var(--text-bright);
}

em, i {
  font-style: italic;
  color: var(--accent-secondary);
}

// Links with sophisticated hover states
a {
  color: var(--accent-primary);
  text-decoration: none;
  position: relative;
  transition: all var(--transition-normal) var(--ease-out);
  
  &:hover, &:focus {
    color: var(--text-brightest);
    text-shadow: var(--glow-cyan);
  }
  
  &:active {
    color: var(--accent-primary-muted);
  }
  
  // Underline effect
  &:not(.button):not(.card):not(.no-underline) {
    &::after {
      content: "";
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 100%;
      height: 1px;
      background-color: currentColor;
      transform: scaleX(0);
      transform-origin: right;
      transition: transform var(--transition-normal) var(--ease-out);
    }
    
    &:hover::after, &:focus::after {
      transform: scaleX(1);
      transform-origin: left;
    }
  }
}

// Lists with enhanced styling
ul, ol {
  margin: 0 0 var(--space-4) var(--space-5);
  
  li {
    margin-bottom: var(--space-2);
    
    &::marker {
      color: var(--accent-primary-muted);
    }
  }
}

ul {
  list-style-type: square;
}

// Code blocks and inline code
pre, code {
  font-family: var(--font-mono);
  font-size: 0.9em;
}

code {
  color: var(--accent-secondary);
  background-color: var(--surface-subtle);
  padding: 0.2em 0.4em;
  border-radius: var(--radius-sm);
}

pre {
  background-color: var(--bg-deeper);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin: var(--space-4) 0;
  overflow-x: auto;
  border: var(--border-thin) solid var(--surface-subtle);
  box-shadow: var(--shadow-regular);
  
  code {
    background-color: transparent;
    padding: 0;
    color: var(--text-base);
  }
}

// Block quote styling
blockquote {
  border-left: var(--border-thick) solid var(--accent-primary-subtle);
  padding: var(--space-4);
  margin: var(--space-6) 0;
  background-color: var(--surface-subtle);
  border-radius: var(--radius-md);
  font-style: italic;
  color: var(--text-muted);
  position: relative;
  
  &::before {
    content: "star";
    position: absolute;
    top: -0.5em;
    left: var(--space-2);
    font-size: 3em;
    color: var(--accent-primary-subtle);
    opacity: 0.5;
  }
  
  p:last-child {
    margin-bottom: 0;
  }
  
  cite {
    display: block;
    margin-top: var(--space-2);
    font-style: normal;
    font-size: 0.9em;
    color: var(--text-dim);
    
    &::before {
      content: "— ";
    }
  }
}

// Horizontal rule
hr {
  border: 0;
  height: var(--border-thin);
  background-image: linear-gradient(
    to right,
    transparent,
    var(--accent-primary-subtle),
    transparent
  );
  margin: var(--space-8) 0;
}

// =========================================================================
// COMPONENTS: Cards & Containers
// =========================================================================

// Card component
.card {
  background-color: var(--glass-light);
  border-radius: var(--radius-xl);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: var(--border-thin) solid var(--surface-regular);
  padding: var(--space-6);
  box-shadow: var(--shadow-medium);
  transition: transform var(--transition-normal) var(--ease-out),
              box-shadow var(--transition-normal) var(--ease-out);
  
  &:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-strong), var(--glow-subtle);
    border-color: var(--surface-strong);
  }
  
  .card-header {
    margin-bottom: var(--space-4);
    border-bottom: var(--border-thin) solid var(--surface-subtle);
    padding-bottom: var(--space-3);
  }
  
  .card-title {
    margin-top: 0;
    margin-bottom: var(--space-2);
  }
  
  .card-footer {
    margin-top: var(--space-4);
    border-top: var(--border-thin) solid var(--surface-subtle);
    padding-top: var(--space-3);
    color: var(--text-muted);
    font-size: var(--text-sm);
  }
}

// Callout components
.callout {
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin: var(--space-6) 0;
  border-left: var(--border-thick) solid var(--accent-primary);
  background-color: var(--surface-subtle);
  
  // Info variant
  &.info {
    border-left-color: var(--state-info);
    background-color: var(--state-info-subtle);
  }
  
  // Success variant
  &.success {
    border-left-color: var(--state-success);
    background-color: var(--state-success-subtle);
  }
  
  // Warning variant
  &.warning {
    border-left-color: var(--state-warning);
    background-color: var(--state-warning-subtle);
  }
  
  // Danger variant
  &.danger {
    border-left-color: var(--state-danger);
    background-color: var(--state-danger-subtle);
  }
  
  .callout-title {
    display: flex;
    align-items: center;
    font-weight: var(--weight-medium);
    margin-bottom: var(--space-2);
    
    svg {
      margin-right: var(--space-2);
    }
  }
  
  .callout-content {
    p:last-child {
      margin-bottom: 0;
    }
  }
}

// Section containers
.section {
  margin: var(--space-12) 0;
  
  &:first-child {
    margin-top: 0;
  }
  
  .section-header {
    margin-bottom: var(--space-6);
    text-align: center;
  }
  
  .section-title {
    font-size: var(--text-3xl);
    margin-bottom: var(--space-2);
  }
  
  .section-description {
    color: var(--text-muted);
    max-width: 40rem;
    margin: 0 auto;
  }
}

// =========================================================================
// COMPONENTS: Buttons & Interactive Elements
// =========================================================================

// Button base styles
.button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-2) var(--space-4);
  border-radius: var(--radius-md);
  font-weight: var(--weight-medium);
  cursor: pointer;
  transition: all var(--transition-normal) var(--ease-out);
  text-decoration: none;
  border: var(--border-thin) solid transparent;
  gap: var(--space-2);
  
  // Primary button
  &.primary {
    background-color: var(--accent-primary);
    color: var(--bg-deepest);
    
    &:hover, &:focus {
      background-color: var(--accent-primary-muted);
      box-shadow: var(--glow-cyan);
    }
    
    &:active {
      transform: translateY(1px);
    }
  }
  
  // Secondary button
  &.secondary {
    background-color: var(--surface-regular);
    color: var(--text-brightest);
    
    &:hover, &:focus {
      background-color: var(--surface-strong);
      box-shadow: var(--shadow-subtle);
    }
    
    &:active {
      transform: translateY(1px);
    }
  }
  
  // Outline button
  &.outline {
    background-color: transparent;
    border-color: var(--accent-primary);
    color: var(--accent-primary);
    
    &:hover, &:focus {
      background-color: var(--surface-subtle);
      border-color: var(--accent-primary-muted);
      color: var(--text-brightest);
      box-shadow: var(--glow-subtle);
    }
    
    &:active {
      transform: translateY(1px);
    }
  }
  
  // Ghost button
  &.ghost {
    background-color: transparent;
    color: var(--text-base);
    
    &:hover, &:focus {
      background-color: var(--surface-subtle);
      color: var(--text-brightest);
    }
    
    &:active {
      transform: translateY(1px);
    }
  }
  
  // Size variants
  &.small {
    font-size: var(--text-sm);
    padding: var(--space-1) var(--space-3);
  }
  
  &.large {
    font-size: var(--text-lg);
    padding: var(--space-3) var(--space-6);
  }
  
  // Icon support
  svg {
    width: 1em;
    height: 1em;
  }
}

// =========================================================================
// COMPONENTS: Navigation & Layout Elements
// =========================================================================

// Header component
.site-header {
  position: sticky;
  top: 0;
  z-index: 10;
  background-color: var(--glass-regular);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-bottom: var(--border-thin) solid var(--surface-subtle);
  height: var(--header-height);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--page-padding);
  
  .site-logo {
    font-weight: var(--weight-bold);
    font-size: var(--text-lg);
    color: var(--text-brightest);
    display: flex;
    align-items: center;
    gap: var(--space-2);
    
    svg {
      width: 1.5em;
      height: 1.5em;
    }
  }
  
  .site-nav {
    display: flex;
    gap: var(--space-4);
    
    a {
      color: var(--text-muted);
      font-weight: var(--weight-medium);
      
      &:hover, &:focus {
        color: var(--text-brightest);
      }
      
      &.active {
        color: var(--accent-primary);
      }
    }
  }
  
  .header-actions {
    display: flex;
    gap: var(--space-2);
  }
}

// Sidebar component
.sidebar {
  width: var(--sidebar-width);
  height: 100vh;
  position: fixed;
  top: 0;
  left: 0;
  background-color: var(--glass-regular);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border-right: var(--border-thin) solid var(--surface-subtle);
  padding: var(--space-6) var(--space-4);
  overflow-y: auto;
  transition: transform var(--transition-normal) var(--ease-out);
  z-index: 20;
  
