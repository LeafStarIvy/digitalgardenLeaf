/* ------------------------------
   Digital Garden: Glass + Theme + Bg switch
   Append to custom-style.scss
   ------------------------------*/

/* Theme override area (user-managed) */
:root {
  /* background image variable (JS will update this) */
  --dg-bg-image: none;
  --dg-bg-opacity: 1;
  --dg-bg-filter: none;

  /* Glass settings (tune one place) */
  --dg-glass-blur: 8px;
  --dg-glass-opacity: 0.66; /* opaque glass */
  --dg-glass-border: rgba(255,255,255,0.08);
  --dg-glass-elev-shadow: 0 6px 18px rgba(0,0,0,0.12);

  /* Transition speeds */
  --dg-transition-fast: 180ms;
  --dg-transition-med: 320ms;
}

/* full-page background layer (behind everything) */
body::before {
  content: "";
  pointer-events: none;
  position: fixed;
  inset: 0;
  z-index: -999; /* behind all page content */
  background-image: var(--dg-bg-image);
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  opacity: var(--dg-bg-opacity);
  filter: var(--dg-bg-filter);
  transition: opacity var(--dg-transition-med), filter var(--dg-transition-med), transform var(--dg-transition-med);
}

/* Glass card class to apply across UI blocks */
.ui-glass {
  background: rgba(255,255,255,var(--dg-glass-opacity)); /* default; overridden in dark mode */
  -webkit-backdrop-filter: blur(var(--dg-glass-blur)) saturate(1.05);
  backdrop-filter: blur(var(--dg-glass-blur)) saturate(1.05);
  border: 1px solid var(--dg-glass-border);
  border-radius: 14px;
  box-shadow: var(--dg-glass-elev-shadow);
  transition: background var(--dg-transition-fast), border var(--dg-transition-fast), color var(--dg-transition-fast);
  color: var(--text-primary); /* will pick from theme variables */
}

/* More opaque variant for "opaque professional glass" */
.ui-glass--opaque {
  --dg-glass-opacity: 0.78;
  border-radius: 16px;
  padding: 0.6rem;
}

/* Example: apply .ui-glass to major containers */
.navbar,
.filetree-sidebar,
.sidebar,
.backlinks,
.toc,
.search-box,
#full-graph,
.graph-fs {
  @extend .ui-glass;
}

/* Buttons for theme controls */
.dg-theme-controls {
  display: flex;
  gap: 8px;
  align-items: center;
  margin-left: auto;
}

.dg-theme-controls .dg-btn {
  background: transparent;
  border: 1px solid transparent;
  padding: 6px 10px;
  border-radius: 10px;
  cursor: pointer;
  font-size: 0.95rem;
  transition: background var(--dg-transition-fast), border-color var(--dg-transition-fast), transform var(--dg-transition-fast);
}
.dg-theme-controls .dg-btn:focus {
  outline: none;
  box-shadow: 0 0 0 3px rgba(100,120,255,0.12);
}
.dg-theme-controls .dg-btn:hover { transform: translateY(-1px); }

/* Hide the background-cycle button when not in light theme by default.
   JS will toggle the 'dg-theme-light' / 'dg-theme-dark' classes on body */
body:not(.dg-theme-light) .dg-btn--bg-cycle { display: none; }

/* Theme variable defaults â€” sensible light theme (will be overridden by theme class) */
:root {
  --dg-text-primary: #0f1724;
  --dg-text-muted: #4b5563;
  --dg-background-primary: rgba(255,255,255,0.55);
  --dg-background-secondary: rgba(255,255,255,0.45);
  --text-primary: var(--dg-text-primary);
  --text-muted: var(--dg-text-muted);

  --graph-main: #0066cc;
  --graph-muted: #7b8aa2;
}

/* Light theme explicit class (applied by JS) */
body.dg-theme-light {
  --dg-text-primary: #0f1724;
  --dg-text-muted: #475569;
  --dg-background-primary: rgba(255,255,255,0.62);
  --dg-background-secondary: rgba(255,255,255,0.42);
  --dg-glass-border: rgba(15,23,36,0.06);
  --text-primary: var(--dg-text-primary);
  --text-muted: var(--dg-text-muted);
  --graph-main: #0066cc;
  --graph-muted: #7b8aa2;
  color: var(--text-primary);
}

/* Dark theme explicit class */
body.dg-theme-dark {
  --dg-text-primary: #e6eef8;
  --dg-text-muted: #9aa6b2;
  --dg-background-primary: rgba(10,12,17,0.45);
  --dg-background-secondary: rgba(10,12,17,0.3);
  --dg-glass-border: rgba(255,255,255,0.06);
  --dg-glass-opacity: 0.20;
  --dg-glass-elev-shadow: 0 8px 30px rgba(0,0,0,0.55);
  --text-primary: var(--dg-text-primary);
  --text-muted: var(--dg-text-muted);
  --graph-main: #6ad1ff;
  --graph-muted: #7f9bad;
  color: var(--text-primary);
}

/* Ensure content uses glass look where appropriate (use .ui-glass on elements) */
.content {
  background: transparent; /* content is inside glass cards, keep transparent */
}

/* Mermaid / Graph boxes (adjust to theme) */
.markdown-preview-view pre.mermaid,
#link-graph,
.dataview-result-list-ul,
.backlinks,
.toc {
  background-color: var(--dg-background-secondary);
}

/* Accessibility helpers */
a, a:visited { color: var(--text-accent, var(--graph-main)); }
code, pre { font-family: var(--font-monospace); }

/* Performance tip: keep number of glass elements reasonable to limit GPU usage */
